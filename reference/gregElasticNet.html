<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Compute an elastic net regression estimator — gregElasticNet • mase</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Compute an elastic net regression estimator — gregElasticNet"><meta name="description" content="Calculates a lasso, ridge or elastic net generalized regression estimator for a finite population mean/proportion or total based on sample data collected from a complex sampling design and auxiliary population data."><meta property="og:description" content="Calculates a lasso, ridge or elastic net generalized regression estimator for a finite population mean/proportion or total based on sample data collected from a complex sampling design and auxiliary population data."><meta property="og:image" content="https://mcconvil.github.io/mase/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mase</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.5.900</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/mcconvil/mase/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Compute an elastic net regression estimator</h1>
      <small class="dont-index">Source: <a href="https://github.com/mcconvil/mase/blob/master/R/gregElasticNet.R" class="external-link"><code>R/gregElasticNet.R</code></a></small>
      <div class="d-none name"><code>gregElasticNet.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Calculates a lasso, ridge or elastic net generalized regression estimator for a finite population mean/proportion or total based on sample data collected from a complex sampling design and auxiliary population data.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">gregElasticNet</span><span class="op">(</span></span>
<span>  <span class="va">y</span>,</span>
<span>  <span class="va">xsample</span>,</span>
<span>  <span class="va">xpop</span>,</span>
<span>  pi <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  model <span class="op">=</span> <span class="st">"linear"</span>,</span>
<span>  pi2 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  var_est <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  var_method <span class="op">=</span> <span class="st">"LinHB"</span>,</span>
<span>  datatype <span class="op">=</span> <span class="st">"raw"</span>,</span>
<span>  N <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  lambda <span class="op">=</span> <span class="st">"lambda.min"</span>,</span>
<span>  B <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  cvfolds <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  weights_method <span class="op">=</span> <span class="st">"ridge"</span>,</span>
<span>  eta <span class="op">=</span> <span class="fl">1e-04</span>,</span>
<span>  fpc <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  messages <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>A numeric vector of the sampled response variable.</p></dd>


<dt id="arg-xsample">xsample<a class="anchor" aria-label="anchor" href="#arg-xsample"></a></dt>
<dd><p>A data frame of the auxiliary data in the sample.</p></dd>


<dt id="arg-xpop">xpop<a class="anchor" aria-label="anchor" href="#arg-xpop"></a></dt>
<dd><p>A data frame of population level auxiliary information.  It must contain the same names as xsample.  If datatype = "raw", must contain unit level data.  If datatype = "totals" or "means", then contains one row of aggregated, population totals or means for the auxiliary data. Default is "raw".</p></dd>


<dt id="arg-pi">pi<a class="anchor" aria-label="anchor" href="#arg-pi"></a></dt>
<dd><p>A numeric vector of inclusion probabilities for each sampled unit in y.  If NULL, then simple random sampling without replacement is assumed.</p></dd>


<dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>A numeric value between 0 and 1 which signifies the mixing parameter for the lasso and ridge penalties in the elastic net.  When alpha = 1, only a lasso penalty is used.  When alpha = 0, only a ridge penalty is used. Default is alpha = 1.</p></dd>


<dt id="arg-model">model<a class="anchor" aria-label="anchor" href="#arg-model"></a></dt>
<dd><p>A string that specifies the regression model to utilize. Options are "linear" or "logistic".</p></dd>


<dt id="arg-pi-">pi2<a class="anchor" aria-label="anchor" href="#arg-pi-"></a></dt>
<dd><p>A square matrix of the joint inclusion probabilities.  Needed for the "LinHT" variance estimator.</p></dd>


<dt id="arg-var-est">var_est<a class="anchor" aria-label="anchor" href="#arg-var-est"></a></dt>
<dd><p>A logical indicating whether or not to compute a variance estimator.  Default is FALSE.</p></dd>


<dt id="arg-var-method">var_method<a class="anchor" aria-label="anchor" href="#arg-var-method"></a></dt>
<dd><p>The method to use when computing the variance estimator.  Options are a Taylor linearized technique: "LinHB"= Hajek-Berger estimator, "LinHH" = Hansen-Hurwitz estimator, "LinHTSRS" = Horvitz-Thompson estimator under simple random sampling without replacement, and "LinHT" = Horvitz-Thompson estimator or a resampling technique: "bootstrapSRS" = bootstrap variance estimator under simple random sampling without replacement. The default is "LinHB".</p></dd>


<dt id="arg-datatype">datatype<a class="anchor" aria-label="anchor" href="#arg-datatype"></a></dt>
<dd><p>A string that specifies the form of population auxiliary data. The possible values are "raw", "totals" or "means" for whether the user is providing population data at the unit level, aggregated to totals, or aggregated to means.  Default is "raw".</p></dd>


<dt id="arg-n">N<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p>A numeric value of the population size. If NULL, it is estimated with the sum of the inverse of the pis.</p></dd>


<dt id="arg-lambda">lambda<a class="anchor" aria-label="anchor" href="#arg-lambda"></a></dt>
<dd><p>A string specifying how to tune the lambda hyper-parameter.  Only used if modelselect = TRUE and defaults to "lambda.min". The possible values are "lambda.min", which is the lambda value associated with the minimum cross validation error or "lambda.1se", which is the lambda value associated with a cross validation error that is one standard error away from the minimum, resulting in a smaller model.</p></dd>


<dt id="arg-b">B<a class="anchor" aria-label="anchor" href="#arg-b"></a></dt>
<dd><p>The number of bootstrap samples if computing the bootstrap variance estimator.  Default is 1000.</p></dd>


<dt id="arg-cvfolds">cvfolds<a class="anchor" aria-label="anchor" href="#arg-cvfolds"></a></dt>
<dd><p>The number of folds for the cross-validation to tune lambda.</p></dd>


<dt id="arg-weights-method">weights_method<a class="anchor" aria-label="anchor" href="#arg-weights-method"></a></dt>
<dd><p>A string specifying which method to use to calculate survey weights. Currently, "ridge" is the only option. The "ridge" method uses a ridge regression approximation to calculate weights (see McConville et al (2017), section 3.2 for details). Support for "calibration" to come soon, which employs the model calibration method of Wu and Sitter (2001).</p></dd>


<dt id="arg-eta">eta<a class="anchor" aria-label="anchor" href="#arg-eta"></a></dt>
<dd><p>A small positive number. Defaults to 0.0001. See McConville et al (2017), section 3.2 for details.</p></dd>


<dt id="arg-fpc">fpc<a class="anchor" aria-label="anchor" href="#arg-fpc"></a></dt>
<dd><p>Default to TRUE, logical for whether or not the variance calculation should include a finite population correction when calculating the "LinHTSRS" or the "SRSbootstrap" variance estimator.</p></dd>


<dt id="arg-messages">messages<a class="anchor" aria-label="anchor" href="#arg-messages"></a></dt>
<dd><p>A logical indicating whether to output the messages internal to mase. Default is TRUE.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list of output containing:</p>
<p>* pop_total: Estimate of population total.</p>
<p>* coefficients: Elastic net coefficient estimates.</p>
<p>* pop_mean: Estimate of the population mean (or proportion).</p>
<p>* pop_total_var: Estimated variance of population total estimate.</p>
<p>* pop_mean_var:Estimated variance of population mean estimate.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>McConville K~S, Breidt F~J, Lee T~C~M, Moisen G~G (2017).
“Model-Assisted Survey Regression Estimation with the Lasso.”
<em>Journal of Survey Statistics and Methodology</em>, <b>5</b>, 131-158.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">IdahoPop</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">IdahoSamp</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">xsample</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">IdahoSamp</span>, <span class="va">COUNTYFIPS</span> <span class="op">==</span> <span class="st">"16055"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">xpop</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">IdahoPop</span>, <span class="va">COUNTYFIPS</span> <span class="op">==</span> <span class="st">"16055"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">gregElasticNet</span><span class="op">(</span>y <span class="op">=</span> <span class="va">xsample</span><span class="op">$</span><span class="va">BA_TPA_ADJ</span>,</span></span>
<span class="r-in"><span>               N <span class="op">=</span> <span class="va">xpop</span><span class="op">$</span><span class="va">npixels</span>,</span></span>
<span class="r-in"><span>               xsample <span class="op">=</span> <span class="va">xsample</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"tcc"</span>, <span class="st">"elev"</span>, <span class="st">"ppt"</span>, <span class="st">"tmean"</span><span class="op">)</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>               xpop <span class="op">=</span> <span class="va">xpop</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"tcc"</span>, <span class="st">"elev"</span>, <span class="st">"ppt"</span>, <span class="st">"tmean"</span><span class="op">)</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>               var_est <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>               var_method <span class="op">=</span> <span class="st">"LinHB"</span>,</span></span>
<span class="r-in"><span>               datatype <span class="op">=</span> <span class="st">"means"</span>,</span></span>
<span class="r-in"><span>               alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Assuming simple random sampling</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $pop_total</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 39824537</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $pop_mean</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 95.13222</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $pop_total_var</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 6.36173e+12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $pop_mean_var</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 36.30188</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $weights</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [1] 8110.6960 8127.9596 7941.2650 3921.2833 7408.5365 4513.9805 5072.4348</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [8] 3113.4666 2668.6354 1624.0108 3050.8954 5767.8385 3309.6885 4758.3397</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [15] 3515.1740 1072.4100 1341.8433 2575.2740 4324.6775 7854.7047 1764.1328</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [22] 2033.4285 5607.9361 4334.7522 6112.1528 1717.4420 2122.6873 3394.7072</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [29] 1673.3116 7415.5079 4197.2586 6329.4901 2163.0174 3216.2893  738.0288</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [36] 1196.9901  665.2475 2882.4305 7690.6379 5571.6106 6321.0567  883.0486</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [43] 3980.2542 4728.0694 6818.1577 2608.9368 3721.9647 2126.2434 1576.9905</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [50] 4366.7803 4596.6650 4106.1462 3914.2026 5396.3184 1239.4076 7226.7119</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [57] 1828.1824 6284.2792 1678.8441 6388.1890 2120.5595 4024.6626 6659.0979</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [64] 6361.2053 4558.0869 7180.3791 1872.7467 3622.3401 3478.5790 4049.6880</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [71] 5161.6505 5505.3941 1062.8080 1378.3264 2591.6583  636.4388 3864.2962</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [78] 5134.7709 1522.9424 5719.7012 5138.4440 4183.3825 7971.2081 3122.3591</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [85] 7943.2118 4054.2819 2670.7986 2655.2078 3870.2713 2620.7725 6439.1774</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [92] 6255.7970 3504.0819 3620.3362 9988.3242 4310.8087 5048.3191 8485.6856</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [99] 6652.4722 2892.1072</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $coefficients</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  (Intercept)          tcc         elev          ppt        tmean </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -25.76086919   0.43723829   0.03828208   0.07555344   0.00000000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kelly McConville, Josh Yamamoto, Becky Tang, George Zhu.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

