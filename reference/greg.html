<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Compute a generalized regression estimator — greg • mase</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Compute a generalized regression estimator — greg"><meta name="description" content="Calculates a generalized regression estimator for a finite population mean/proportion or total based on sample data collected from a complex sampling design and auxiliary population data."><meta property="og:description" content="Calculates a generalized regression estimator for a finite population mean/proportion or total based on sample data collected from a complex sampling design and auxiliary population data."><meta property="og:image" content="https://mcconvil.github.io/mase/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mase</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.5.900</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/mcconvil/mase/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Compute a generalized regression estimator</h1>
      <small class="dont-index">Source: <a href="https://github.com/mcconvil/mase/blob/master/R/GREG.R" class="external-link"><code>R/GREG.R</code></a></small>
      <div class="d-none name"><code>greg.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Calculates a generalized regression estimator for a finite population mean/proportion or total based on sample data collected from a complex sampling design and auxiliary population data.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">greg</span><span class="op">(</span></span>
<span>  <span class="va">y</span>,</span>
<span>  <span class="va">xsample</span>,</span>
<span>  <span class="va">xpop</span>,</span>
<span>  pi <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  model <span class="op">=</span> <span class="st">"linear"</span>,</span>
<span>  pi2 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  var_est <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  var_method <span class="op">=</span> <span class="st">"LinHB"</span>,</span>
<span>  datatype <span class="op">=</span> <span class="st">"raw"</span>,</span>
<span>  N <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  modelselect <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  lambda <span class="op">=</span> <span class="st">"lambda.min"</span>,</span>
<span>  B <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  fpc <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  messages <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>A numeric vector of the sampled response variable.</p></dd>


<dt id="arg-xsample">xsample<a class="anchor" aria-label="anchor" href="#arg-xsample"></a></dt>
<dd><p>A data frame of the auxiliary data in the sample.</p></dd>


<dt id="arg-xpop">xpop<a class="anchor" aria-label="anchor" href="#arg-xpop"></a></dt>
<dd><p>A data frame of population level auxiliary information.  It must contain the same names as xsample.  If datatype = "raw", must contain unit level data.  If datatype = "totals" or "means", then contains one row of aggregated, population totals or means for the auxiliary data. Default is "raw".</p></dd>


<dt id="arg-pi">pi<a class="anchor" aria-label="anchor" href="#arg-pi"></a></dt>
<dd><p>A numeric vector of inclusion probabilities for each sampled unit in y.  If NULL, then simple random sampling without replacement is assumed.</p></dd>


<dt id="arg-model">model<a class="anchor" aria-label="anchor" href="#arg-model"></a></dt>
<dd><p>A string that specifies the regression model to utilize. Options are "linear" or "logistic".</p></dd>


<dt id="arg-pi-">pi2<a class="anchor" aria-label="anchor" href="#arg-pi-"></a></dt>
<dd><p>A square matrix of the joint inclusion probabilities.  Needed for the "LinHT" variance estimator.</p></dd>


<dt id="arg-var-est">var_est<a class="anchor" aria-label="anchor" href="#arg-var-est"></a></dt>
<dd><p>A logical indicating whether or not to compute a variance estimator.  Default is FALSE.</p></dd>


<dt id="arg-var-method">var_method<a class="anchor" aria-label="anchor" href="#arg-var-method"></a></dt>
<dd><p>The method to use when computing the variance estimator.  Options are a Taylor linearized technique: "LinHB"= Hajek-Berger estimator, "LinHH" = Hansen-Hurwitz estimator, "LinHTSRS" = Horvitz-Thompson estimator under simple random sampling without replacement, and "LinHT" = Horvitz-Thompson estimator or a resampling technique: "bootstrapSRS" = bootstrap variance estimator under simple random sampling without replacement. The default is "LinHB".</p></dd>


<dt id="arg-datatype">datatype<a class="anchor" aria-label="anchor" href="#arg-datatype"></a></dt>
<dd><p>A string that specifies the form of population auxiliary data. The possible values are "raw", "totals" or "means" for whether the user is providing population data at the unit level, aggregated to totals, or aggregated to means.  Default is "raw".</p></dd>


<dt id="arg-n">N<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p>A numeric value of the population size. If NULL, it is estimated with the sum of the inverse of the pis.</p></dd>


<dt id="arg-modelselect">modelselect<a class="anchor" aria-label="anchor" href="#arg-modelselect"></a></dt>
<dd><p>A logical for whether or not to run lasso regression first and then fit the model using only the predictors with non-zero lasso coefficients. Default is FALSE.</p></dd>


<dt id="arg-lambda">lambda<a class="anchor" aria-label="anchor" href="#arg-lambda"></a></dt>
<dd><p>A string specifying how to tune the lasso hyper-parameter.  Only used if modelselect = TRUE and defaults to "lambda.min". The possible values are "lambda.min", which is the lambda value associated with the minimum cross validation error or "lambda.1se", which is the lambda value associated with a cross validation error that is one standard error away from the minimum, resulting in a smaller model.</p></dd>


<dt id="arg-b">B<a class="anchor" aria-label="anchor" href="#arg-b"></a></dt>
<dd><p>The number of bootstrap samples if computing the bootstrap variance estimator.  Default is 1000.</p></dd>


<dt id="arg-fpc">fpc<a class="anchor" aria-label="anchor" href="#arg-fpc"></a></dt>
<dd><p>Default to TRUE, logical for whether or not the variance calculation should include a finite population correction when calculating the "LinHTSRS" or the "SRSbootstrap" variance estimator.</p></dd>


<dt id="arg-messages">messages<a class="anchor" aria-label="anchor" href="#arg-messages"></a></dt>
<dd><p>A logical indicating whether to output the messages internal to mase. Default is TRUE.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list of output containing:</p>
<p>* pop_total: Estimate of population total.</p>
<p>* pop_mean: Estimate of the population mean (or proportion).</p>
<p>* weights: Survey weights produced by GREG (linear model only).</p>
<p>* pop_total_var: Estimated variance of population total estimate.</p>
<p>* pop_mean_var: Estimated variance of population mean estimate.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Cassel C~M, Sarndal C~E, Wretman J~H (1976).
“Some results on generalized difference estimation and generalized regression estimation for finite populations.”
<em>Biometrika</em>, <b>63</b>, 615–620.</p>
<p>Sarndal C~E, Swensson B, Wretman J (1992).
<em>Model Assisted Survey Sampling</em>.
Springer-Verlag, New York.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Attaching package: ‘dplyr’</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following objects are masked from ‘package:stats’:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     filter, lag</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following objects are masked from ‘package:base’:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     intersect, setdiff, setequal, union</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">IdahoPop</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">IdahoSamp</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">xsample</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">IdahoSamp</span>, <span class="va">COUNTYFIPS</span> <span class="op">==</span> <span class="st">"16055"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">xpop</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">IdahoPop</span>, <span class="va">COUNTYFIPS</span> <span class="op">==</span> <span class="st">"16055"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">greg</span><span class="op">(</span>y <span class="op">=</span> <span class="va">xsample</span><span class="op">$</span><span class="va">BA_TPA_ADJ</span>,</span></span>
<span class="r-in"><span>     N <span class="op">=</span> <span class="va">xpop</span><span class="op">$</span><span class="va">npixels</span>,</span></span>
<span class="r-in"><span>     xsample <span class="op">=</span> <span class="va">xsample</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"tcc"</span>, <span class="st">"elev"</span><span class="op">)</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>     xpop <span class="op">=</span> <span class="va">xpop</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"tcc"</span>, <span class="st">"elev"</span><span class="op">)</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>     var_est <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>     var_method <span class="op">=</span> <span class="st">"LinHB"</span>,</span></span>
<span class="r-in"><span>     datatype <span class="op">=</span> <span class="st">"means"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Assuming simple random sampling</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $pop_total</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 39521557</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $pop_mean</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 94.40847</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $pop_total_var</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 6.478447e+12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $pop_mean_var</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 36.9679</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $weights</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [1] 8060.960 6489.037 6929.206 3145.983 8041.396 3737.945 5687.480 3577.979</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [9] 3020.678 1690.956 2427.990 6469.919 3123.403 4879.079 2639.280 2624.305</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [17] 1954.575 1186.989 3207.814 8886.670 3196.904 1876.082 4186.524 3406.140</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [25] 5158.757 2823.357 2449.285 4110.968 1848.589 8638.148 3758.716 4917.963</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [33] 2738.744 2695.673 1852.252 2086.525 2920.164 2799.124 7854.180 4707.118</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [41] 5730.753 1262.825 4115.680 4101.833 7274.657 2607.800 2055.045 2659.727</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [49] 1947.451 4639.413 3681.351 4315.134 3403.483 4823.892 1674.373 7991.121</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [57] 2524.517 6087.918 1799.399 5632.293 2457.738 3312.270 6021.943 5538.423</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [65] 3995.847 6102.368 3174.927 4497.681 4476.307 2101.377 6093.312 5503.605</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [73] 1478.582 2305.018 2687.543 2518.520 3852.988 5259.550 2145.174 5314.536</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [81] 5218.411 3132.459 7656.256 3177.261 8595.077 3461.808 2174.599 2428.715</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [89] 3508.262 3680.625 5900.982 5897.923 3362.667 2789.342 9305.020 5559.150</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [97] 5000.197 8538.360 7337.170 2925.479</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $coefficients</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  (Intercept)          tcc         elev </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -30.26159045   0.79210774   0.09679431 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kelly McConville, Josh Yamamoto, Becky Tang, George Zhu, Grayson White.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

